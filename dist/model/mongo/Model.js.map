{"version":3,"sources":["../../../../src/ui5/model/mongo/Model.js"],"names":[],"mappings":"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","file":"Model.js","sourcesContent":["/*!\n * ${copyright}\n */\n\n/**\n * Meteor UI5 Mongo Model\n * @namespace meteor-ui5.model.mongo\n */\n\n// Provides the base implementation for all model implementations\nsap.ui.define([\n  'jquery.sap.global',\n  'sap/ui/model/Model',\n  'sap/ui/model/BindingMode',\n  'sap/ui/model/Context',\n  './DocumentListBinding',\n  './PropertyListBinding',\n  './PropertyBinding',\n  './ContextBinding',\n  'sap/ui/model/FilterOperator',\n], function(\n  jQuery,\n  Model,\n  BindingMode,\n  Context,\n  DocumentListBinding,\n  PropertyListBinding,\n  PropertyBinding,\n  ContextBinding,\n  FilterOperator) {\n  \"use strict\";\n\n  /**\n   * Constructor for a new Model.\n   *\n   * Every Model is a MessageProcessor that is able to handle Messages with the normal binding path syntax in the target.\n   *\n   * @class\n   *\n   * @extends sap.ui.model.Model\n   *\n   * @author PropellerLabs.io\n   * @version ${version}\n   *\n   * @constructor\n   * @public\n   * @alias meteor-ui5.model.mongo.Model\n   */\n  var cModel = Model.extend(\"meteor-ui5.model.mongo.Model\",  {\n\n    constructor: function(iSizeLimit) {\n      Model.apply(this, arguments);\n\n      this.oData = {};\n      this.bDestroyed = false;\n      this.aBindings = [];\n      this.mContexts = {};\n      this.iSizeLimit = iSizeLimit || 100;\n      this.sDefaultBindingMode = BindingMode.OneWay;\n      this.mSupportedBindingModes = {\n        \"OneWay\": true,\n        \"TwoWay\": false,\n        \"OneTime\": false\n      };\n      this.bLegacySyntax = false;\n      this.sUpdateTimer = null;\n    },\n\n  });\n\n\n  /**\n   * Return new PropertyBinding for given parameters\n   *\n   * @name meteor-ui5.model.mongo.Model.prototype.bindProperty\n   * @function\n   * @param {string}\n   *         sPath the path pointing to the property that should be bound\n   * @param {object}\n   *         [oContext=null] the context object for this databinding (optional)\n   * @param {object}\n   *         [mParameters=null] additional model specific parameters (optional)\n   * @return {sap.ui.model.PropertyBinding}\n   *\n   * @public\n   */\n  cModel.prototype.bindProperty = function(sPath, oContext, mParameters) {\n    var oBinding = new PropertyBinding(this, sPath, oContext, mParameters);\n    return oBinding;\n  }\n\n\n  /**\n   * Return new DocumentListBinding for given parameters\n   *\n   * @name meteor-ui5.model.mongo.Model.prototype.bindList\n   * @function\n   * @param {string}\n   *         sPath the path pointing to the list / array that should be bound\n   * @param {object}\n   *         [oContext=null] the context object for this databinding (optional)\n   * @param {sap.ui.model.Sorter}\n   *         [aSorters=null] initial sort order (can be either a sorter or an array of sorters) (optional)\n   * @param {array}\n   *         [aFilters=null] predefined filter/s (can be either a filter or an array of filters) (optional)\n   * @param {object}\n   *         [mParameters=null] additional model specific parameters (optional)\n   * @return {sap.ui.model.ListBinding}\n\n   * @public\n   */\n  cModel.prototype.bindList = function(sPath, oContext, aSorters, aFilters, mParameters) {\n    var oBinding;\n    if (oContext) {\n      // Binding list to array property in single document\n      oBinding = new PropertyListBinding(this, sPath, oContext, aSorters, aFilters, mParameters);\n    } else {\n      // Binding list to documents in Mongo\n      oBinding = new DocumentListBinding(this, sPath, oContext, aSorters, aFilters, mParameters);\n    }\n    return oBinding;\n  }\n\n  /**\n   * Implement in inheriting classes\n   *\n   * @name meteor-ui5.model.mongo.Model.prototype.bindTree\n   * @function\n   * @param {string}\n   *         sPath the path pointing to the tree / array that should be bound\n   * @param {object}\n   *         [oContext=null] the context object for this databinding (optional)\n   * @param {array}\n   *         [aFilters=null] predefined filter/s contained in an array (optional)\n   * @param {object}\n   *         [mParameters=null] additional model specific parameters (optional)\n   * @param {array}\n   *         [aSorters=null] predefined sap.ui.model.sorter/s contained in an array (optional)\n   * @return {sap.ui.model.TreeBinding}\n\n   * @public\n   */\n  // TODO implement this.  Check first if controls that use this haven't all been\n  // deprecated.\n\n  /**\n   * Create binding context. (Implementation copied from ClientModel.js)\n   *\n   * @name meteor-ui5.model.mongo.Model.prototype.createBindingContext\n   * @function\n   * @param {string}\n   *         sPath the path to create the new context from\n   * @param {object}\n   *\t\t   [oContext=null] the context which should be used to create the new binding context\n   * @param {object}\n   *\t\t   [mParameters=null] the parameters used to create the new binding context\n   * @param {function}\n   *         [fnCallBack] the function which should be called after the binding context has been created\n   * @param {boolean}\n   *         [bReload] force reload even if data is already available. For server side models this should\n   *                   refetch the data from the server\n   * @return {sap.ui.model.Context} the binding context, if it could be created synchronously\n   *\n   * @public\n   */\n  cModel.prototype.createBindingContext = function(sPath, oContext, mParameters, fnCallBack) {\n    // optional parameter handling\n    if (typeof oContext == \"function\") {\n      fnCallBack = oContext;\n      oContext = null;\n    }\n    if (typeof mParameters == \"function\") {\n      fnCallBack = mParameters;\n      mParameters = null;\n    }\n    // resolve path and create context\n    var sContextPath = this.resolve(sPath, oContext),\n      oNewContext = (sContextPath == undefined) ? undefined : this.getContext(sContextPath ? sContextPath : \"/\");\n    if (!oNewContext) {\n      oNewContext = null;\n    }\n    if (fnCallBack) {\n      fnCallBack(oNewContext);\n    }\n    return oNewContext;\n  };\n\n  /**\n   * Implement in inheriting classes\n   *\n   * @name meteor-ui5.model.mongo.Model.prototype.destroyBindingContext\n   * @function\n   * @param {object}\n   *         oContext to destroy\n\n   * @public\n   */\n  //TODO implement this\n\n  /**\n   * Alternative to lodash _.get so we don't have to include whole library\n   *\n   * Code taken from: https://gist.github.com/jeneg/9767afdcca45601ea44930ea03e0febf\n   * TODO: test that this works in all likely instances\n   * @param  {object} obj The object containing the desired property\n   * @param  {string} path The path to the property\n   * @param  {string|number} def Default value if property not found\n   * @return {string|number} The property value\n   */\n  cModel.prototype._get = function(obj, path, def) {\n    var fullPath = path\n      .replace(/\\[/g, '.')\n      .replace(/]/g, '')\n      .split('.')\n      .filter(Boolean);\n\n    return fullPath.every(everyFunc) ? obj : def;\n\n    function everyFunc(step) {\n      return !(step && (obj = obj[step]) === undefined);\n    }\n  };\n\n\n  /**\n   * Implement in inheriting classes\n   *\n   * @name meteor-ui5.model.mongo.Model.prototype.getProperty\n   * @function\n   * @param {string}\n   *         sPath the path to where to read the attribute value\n   * @param {object}\n   *\t\t   [oContext=null] the context with which the path should be resolved\n   * @public\n   */\n  cModel.prototype.getProperty = function(sPath, oContext) {\n    let propertyValue;\n\n    // Check we have a context or we can't return a property - not yet sure\n    // why this is sometimes being called when context hasn't been set yet\n    // (Grid Table)\n    if (!oContext) {\n      return;\n    }\n\n    // Get single document\n    var oComponents = this._getPathComponents(sPath, oContext);\n    // collectionName: \"\",\n    // documentId: \"\",\n    // propertyPath: \"\",\n    var document = Mongo.Collection.get(oComponents.collectionName).findOne(oComponents.documentId);\n    if (document) {\n      if (oComponents.propertyPath) {\n        // Return property\n        if (oComponents.propertyPath.charAt(0) === \"?\") {\n          propertyValue = this._getLookupProperty(document, oComponents.propertyPath);\n        } else {\n          // Regular property - get from current document\n          propertyValue = this._get(document, oComponents.propertyPath);\n        }\n      } else {\n        // Return document (e.g. called by getObject)\n        propertyValue = document;\n      }\n    }\n\n    return propertyValue;\n  }\n\n  cModel.prototype._getLookupProperty = function(oCurrentDocument, sLookupPath) {\n    // This is a lookup query, e.g.: \"?Customers(CustomerID)/CompanyName\"\n    // Create context and path to lookup property in another collection\n\n    // Build context path for querying lookup collection.  Note:\n    // components.documentId actually contains property name in\n    // current document\n    var oLookupComponents = this._getPathComponents(sLookupPath);\n    const sLookupContextPath =\n      \"/\" +\n      oLookupComponents.collectionName +\n      \"(\" +\n      oCurrentDocument[oLookupComponents.documentId] +\n      \")\";\n\n    // Get context for querying lookup collection if it already exists\n    // or create one\n    const oLookupContext = this.getContext(sLookupContextPath);\n\n    // Call standard getProperty with new context and path property\n    return this.getProperty(\n      oLookupComponents.propertyPath,\n      oLookupContext\n    );\n  }\n\n  /**\n   * Implement in inheriting classes\n   *\n   * @param {string}\n   *         sPath the path to where to read the object\n   * @param {object}\n   *\t\t   [oContext=null] the context with which the path should be resolved\n   * @public\n   */\n  cModel.prototype.getObject = function(sPath, oContext) {\n    return this.getProperty(sPath, oContext);\n  };\n\n  /* Resolve and return all components from path */\n  cModel.prototype._getPathComponents = function(sPath, oContext) {\n\n    // Define object this method returns.  Some or all properties will be\n    // set in this method.\n    let oComponents = {\n      collectionName: \"\",\n      documentId: \"\",\n      propertyPath: \"\",\n    };\n\n    // Resolve path from oContext and sPath into one full path\n    let sFullPath = oContext ? this.resolve(sPath, oContext) : sPath;\n\n    // Validate path\n    const sFirstChar = sFullPath.charAt(0);\n    if (sFirstChar === \"?\") {\n      // Question mark denotes Meteor Mongo model Lookup binding path\n      // Convert it to a regular root (non-relative path)\n      sFullPath = \"/\" + sFullPath.slice(1);\n    } else if (sFirstChar !== \"/\") {\n      const sError = \"Cannot find root element (Mongo Collection).\";\n      jQuery.sap.log.fatal(sError);\n      this.fireParseError({\n        srcText: sError\n      });\n    }\n\n    // Split path into components at forward slash\n    var aComponents = sFullPath.split(\"/\");\n    if (aComponents[0] === \"\") {\n      aComponents.shift();\n    }\n\n    // Validate components\n    if (aComponents.length < 1) {\n      var sError = \"Unsupported binding path: \" + sFullPath;\n      jQuery.sap.log.fatal(sError);\n      oModel.fireParseError({\n        srcText: sError\n      });\n    }\n\n    // Interpret first componet - Collection name - possibly with document id\n    const sCollectionComponent = aComponents[0];\n    const openParens = sCollectionComponent.indexOf(\"(\");\n    if (openParens < 0) {\n      // No document id - whole component is collection name\n      oComponents.collectionName = sCollectionComponent;\n    } else {\n      // Get collection name and document id\n      const closeParens = sCollectionComponent.indexOf(\")\");\n      oComponents.collectionName = sCollectionComponent.substring(0, openParens);\n      oComponents.documentId = sCollectionComponent.substring(openParens + 1, closeParens);\n    }\n\n    // Return remaining components as property path\n    aComponents.shift();\n    var sPropertyPath = aComponents.join('.');\n    if (sPropertyPath) {\n      var iCloseParens = sPropertyPath.indexOf(\")\");\n      if (iCloseParens > -1) {\n        // Replace period directly after closing parenthesis with \"/\"\n        // TODO fix this hack - don't quite understand yet why this is necessary\n        // but seems to be for lookups.\n        var iFirstAfterCloseParens = iCloseParens + 1;\n        if (sPropertyPath.charAt(iFirstAfterCloseParens) === \".\") {\n          sPropertyPath = sPropertyPath.substr(0, iFirstAfterCloseParens) + \"/\" +\n            sPropertyPath.substr(iCloseParens + 1);\n        }\n      }\n    }\n    oComponents.propertyPath = sPropertyPath;\n\n    return oComponents;\n  };\n\n  /* Builds and runs mongo collection find and returns meteor cursor */\n  cModel.prototype.runQuery = function(sPath, oContext, aSorters, aFilters) {\n    // Resolve path and get components (collection name, document id)\n    var oPathComponents = this._getPathComponents(sPath, oContext);\n\n    // Get Collection\n    var oCollection = Mongo.Collection.get(oPathComponents.collectionName);\n\n    // Build mongo selector\n    let selector = {};\n    if (oPathComponents.documentId) {\n      selector._id = oPathComponents.documentId;\n    } else if (aFilters && aFilters.length) {\n      selector = this._buildMongoSelector(aFilters);\n    }\n\n    // Build query options\n    let options = {\n      limit: this.iSizeLimit\n    };\n\n    // Build sorter option\n    if (aSorters && aSorters.length) {\n      options.sort = this._buildMongoSortSpecifier(aSorters);\n    }\n\n    // Execute query and return cursor\n    const oCursor = oCollection.find(selector, options);\n    return oCursor;\n\n  }\n\n  cModel.prototype._buildMongoSelector = function(aFilters) {\n    let oMongoSelector = {};\n    // Build mongo selector incorporating each filter\n\n    // Build set of properties with an array of filters for each.  These will\n    // will be combined with and/or conditions into the mongo selector later\n    const properties = new Map();\n    aFilters.forEach((oFilter) => {\n      // Validate: We don't currently support multi-filter\n      if (oFilter._bMultiFilter) {\n        const sError = \"MultiFilter not yet supported by ListBinding.\";\n        jQuery.sap.log.fatal(sError);\n        this.oModel.fireParseError({\n          srcText: sError\n        });\n        return;\n      }\n\n      // Build mongo expression according to UI5 filter operator\n      // Example filter object:\n      // {sPath: \"Country\", sOperator: \"EQ\", oValue1: \"USA\", oValue2: undefined, _bMultiFilter: false}\n      let oMongoExpression = {};\n      switch (oFilter.sOperator) {\n        case FilterOperator.BT:\n          oMongoExpression[\"$gte\"] = oFilter.oValue1;\n          oMongoExpression[\"$lte\"] = oFilter.oValue2;\n          break;\n        case FilterOperator.Contains:\n          // TODO investigate performance options. Need to also determine if\n          // we can dynamically determine and use $text if a text index has been\n          // created.\n          // In the mean time, build a regex.\n          oMongoExpression[\"$regex\"] = new RegExp(oFilter.oValue1);\n          oMongoExpression[\"$options\"] = \"i\"; // case-insensitive\n          break;\n        case FilterOperator.StartsWith:\n          oMongoExpression[\"$regex\"] = new RegExp(\"^\" + oFilter.oValue1);\n          oMongoExpression[\"$options\"] = \"i\"; // case-insensitive\n          break;\n        case FilterOperator.EndsWith:\n          oMongoExpression[\"$regex\"] = new RegExp(oFilter.oValue1 + \"$\");\n          oMongoExpression[\"$options\"] = \"i\"; // case-insensitive\n          break;\n        case FilterOperator.EQ:\n          // TODO add $eq when supported in mini-mongo (version 1.4?).  Hope this\n          // work around doesn't bite us in the mean time.  Refer:\n          // https://github.com/meteor/meteor/issues/4142\n          oMongoExpression = oFilter.oValue1;\n          break;\n        case FilterOperator.GE:\n          oMongoExpression[\"$gte\"] = oFilter.oValue1;\n        case FilterOperator.GT:\n          oMongoExpression[\"$gt\"] = oFilter.oValue1;\n          break;\n        case FilterOperator.LE:\n          oMongoExpression[\"$lte\"] = oFilter.oValue1;\n          break;\n        case FilterOperator.LT:\n          oMongoExpression[\"$lt\"] = oFilter.oValue1;\n          break;\n        case FilterOperator.NE:\n          //TODO: Test.  Valid in Mongo, not sure if minimongo supports - see\n          // EQ FilterOperator above\n          oMongoExpression[\"$ne\"] = oFilter.oValue1;\n          break;\n        default:\n          const sError = \"Filter operator \" + oFilter.sOperator + \" not supported.\";\n          jQuery.sap.log.fatal(sError);\n          this.oModel.fireParseError({\n            srcText: sError\n          });\n          return;\n      }\n\n      // Add current property to the map if it doesn't already exist\n      const propertyName = oFilter.sPath;\n      if (!properties.has(propertyName)) {\n        properties.set(propertyName, []);\n      }\n\n      // Add current property selector to map\n      const propertySelector = {};\n      propertySelector[propertyName] = oMongoExpression;\n      properties.get(propertyName).push(propertySelector);\n    });\n\n    // Combine propery selectors for different properties using mongo $and\n    const $and = [];\n    properties.forEach(function(expressions) {\n      // Combine expressions for single property using mongo $or (if multiple)\n      if (expressions.length === 1) {\n        $and.push(expressions[0]);\n      } else {\n        $and.push({\n          $or: expressions\n        })\n      }\n    });\n\n    if ($and.length > 1) {\n      oMongoSelector[\"$and\"] = $and;\n    } else {\n      oMongoSelector = $and[0];\n    }\n    return oMongoSelector;\n  };\n\n  cModel.prototype._buildMongoSortSpecifier = function(aSorters) {\n    let oMongoSortSpecifier = {};\n    aSorters.forEach((oSorter) => {\n      // Don't know what options need to be supported yet but currently\n      // we only support sorting based on a simple property with ascending or\n      // descending option.  Validate that this sorter seems to meet that\n      // criteria.\n      const bHasSlash = (oSorter.sPath.indexOf(\"/\") > -1);\n      const bHasPeriod = (oSorter.sPath.indexOf(\".\") > -1);\n      if (bHasSlash || bHasPeriod) {\n        const sError = \"Currently unsupported list sorting path: \" + oSorter.sPath;\n        jQuery.sap.log.fatal(sError);\n        this.oModel.fireParseError({\n          srcText: sError\n        });\n        return;\n      }\n\n      // Validate that we don't have a custom comparator function (if not possible\n      // with Mongo read - may be able to add it later as post query javascript\n      // filtering)\n      if (oSorter.fnCompare) {\n        const sError = \"Custom sort comparator functions currently unsupported\";\n        jQuery.sap.log.fatal(sError);\n        this.oModel.fireParseError({\n          srcText: sError\n        });\n        return;\n      }\n\n      // Build mongo sort specifier\n      oMongoSortSpecifier[oSorter.sPath] = oSorter.bDescending ? -1 : 1;\n    });\n\n    return oMongoSortSpecifier;\n  };\n\n\n  /**\n   * Create ContextBinding\n   *\n   * @name meteor-ui5.model.mongo.Model.prototype.bindContext\n   * @function\n   * @param {string | object}\n   *         sPath the path pointing to the property that should be bound or an object\n   *         which contains the following parameter properties: path, context, parameters\n   * @param {object}\n   *         [oContext=null] the context object for this databinding (optional)\n   * @param {object}\n   *         [mParameters=null] additional model specific parameters (optional)\n   * @param {object}\n   *         [oEvents=null] event handlers can be passed to the binding ({change:myHandler})\n   * @return {sap.ui.model.ContextBinding}\n   *\n   * @public\n   */\n  cModel.prototype.bindContext = function(sPath, oContext, mParameters) {\n    var oBinding = new ContextBinding(this, sPath, oContext, mParameters);\n    return oBinding;\n  };\n\n  /**\n   * @see sap.ui.model.Model.prototype.bindElement\n   *\n   */\n\n  /**\n   * Gets a binding context. If context already exists, return it from the map,\n   * otherwise create one using the context constructor.\n   *\n   * @param {string} sPath the path\n   */\n  cModel.prototype.getContext = function(sPath) {\n    if (!jQuery.sap.startsWith(sPath, \"/\")) {\n      throw new Error(\"Path \" + sPath + \" must start with a / \");\n    }\n    var oContext = this.mContexts[sPath];\n    if (!oContext) {\n      oContext = new Context(this, sPath);\n      this.mContexts[sPath] = oContext;\n    }\n    return oContext;\n  };\n\n  /**\n   * Resolve the path relative to the given context.\n   *\n   * If a relative path is given (not starting with a '/') but no context,\n   * then the path can't be resolved and undefined is returned.\n   *\n   * For backward compatibility, the behavior of this method can be changed by\n   * setting the 'legacySyntax' property. Then an unresolvable, relative path\n   * is automatically converted into an absolute path.\n   *\n   * @param {string} sPath path to resolve\n   * @param {sap.ui.core.Context} [oContext] context to resolve a relative path against\n   * @return {string} resolved path or undefined\n   */\n  cModel.prototype.resolve = function(sPath, oContext) {\n    var bIsRelative = typeof sPath == \"string\" && !jQuery.sap.startsWith(sPath, \"/\"),\n      sResolvedPath = sPath,\n      sContextPath;\n    if (bIsRelative) {\n      if (oContext) {\n        sContextPath = oContext.getPath();\n        sResolvedPath = sContextPath + (jQuery.sap.endsWith(sContextPath, \"/\") ? \"\" : \"/\") + sPath;\n      } else {\n        sResolvedPath = this.isLegacySyntax() ? \"/\" + sPath : undefined;\n      }\n    }\n    if (!sPath && oContext) {\n      sResolvedPath = oContext.getPath();\n    }\n    // invariant: path never ends with a slash ... if root is requested we return /\n    if (sResolvedPath && sResolvedPath !== \"/\" && jQuery.sap.endsWith(sResolvedPath, \"/\")) {\n      sResolvedPath = sResolvedPath.substr(0, sResolvedPath.length - 1);\n    }\n    return sResolvedPath;\n  };\n\n  /**\n   * Destroys the model and clears the model data.\n   * A model implementation may override this function and perform model specific cleanup tasks e.g.\n   * abort requests, prevent new requests, etc.\n   *\n   * @see sap.ui.base.Object.prototype.destroy\n   * @public\n   */\n  cModel.prototype.destroy = function() {\n    // Call destroy on each binding where method exists\n    this.aBindings.forEach(function(oBinding) {\n      if (oBinding.hasOwnProperty(\"destroy\")) {\n        oBinding.destroy();\n      }\n    });\n\n    // Call super\n    Model.prototype.destroy.apply(this, arguments);\n  };\n\n  return cModel;\n\n});\n"]}